{"mappings":"quBAAA,IAAAA,EAAAC,EAAA,6DAOA,IAAIC,EACAC,EAEJ,MAAMC,EAAKJ,EAAAK,aAAaC,EAAAC,KAClBC,EAAOC,EAAAC,UAEb,IAAIC,EAAO,GAEXC,eAAeC,EAASC,GACpB,IAGI,aAF+BC,EAAAC,WAAWF,GAG5C,MAAMG,KAMZ,SAASC,EAAaC,EAAMC,EAAcC,GAEtC,MAAMC,EAAUC,SAASC,cAAc,KACvCF,EAAQG,UAAY,UAEpBH,EAAQI,aAAa,OAAQ,qBAAqBP,EAAKQ,MAEvD,MAAMC,EAAcT,EAAKU,OAASV,EAAKU,OAAO,GAAK,8EAIhDT,EAAaU,OAAS,IAErB5B,EAAkBkB,EAAaW,MAAMC,IAEjCA,EAAYL,GAAOR,EAAKQ,OAKhC,MAAMM,EAAqB/B,EAC3B,sFACA,4EAEAoB,EAAQY,UAAY,4GAuBPN,oLAGOT,EAAAgB,6EAEQhB,EAAAiB,kCACxBH,4DAgBRZ,EAAAgB,YAAef,GAEX,MAAAgB,EAAqBhB,EAAQiB,cAAc,oBAK/CD,EAASE,iBAAA,SAAA5B,MAAO6B,IAEZA,EAAMC,iBACNC,QAAOC,IAASH,GACnBrB,EAAAyB,KAAA1B,GAED2B,EAAA1B,GACYjB,SAAE4C,EAAAC,mBAAA5C,EAAAD,EAAA8C,IAAA7B,GACRkB,EAAAZ,aAAA,YAAA,GACAY,EAAAJ,UAAA,gBACAS,QAAAC,IAAAzC,qBAIE2C,EAAO1B,GAKX8B,aAAAC,QAAA,OAAAC,KAAAC,UAAWjC,iPCzHfnB,EAAA,+FASWI,aAAaC,EAAAC,KAExBK,eAAe0C,EAAWxC,GAEtB,IACI,MAAMyC,EAAgBvD,EAAAwD,WAAW1C,EAAI,UAd7C2C,KAegBA,SAAezD,EAAA0D,QAAQH,GAa/B,OAZyBE,EAAKE,KAAKC,IAIzB,IAECA,EAAIC,WAQjB,MAAM5C,GAEJ0B,QAAQC,IAAI3B","sources":["src/itemShowcase.js","src/utils/item.js"],"sourcesContent":["import { getFirestore } from \"firebase/firestore\";\r\nimport {createFirebaseCart, getFirebaseCart} from \"./utils/cartFunction\";\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nimport {app} from \"./firebase_app\";\r\n\r\nimport { fetchItems } from \"./utils/item\";\r\n\r\nlet cartHasProducts;\r\nlet userHasLoggedIn = undefined;\r\n\r\nconst db = getFirestore(app);\r\nconst auth = getAuth();\r\n\r\nlet cart = [];\r\n\r\nasync function getItems(db) {\r\n    try {\r\n        const firebaseProducts = await fetchItems(db);\r\n\r\n        return firebaseProducts;\r\n    } catch(e) {\r\n        //console.log(e);\r\n    }\r\n\r\n}\r\n\r\nfunction displayItems(item, shoppingCart, itemsArea){\r\n\r\n    const product = document.createElement(\"a\");\r\n    product.className = \"product\";\r\n    \r\n    product.setAttribute(\"href\", `./product.html?id=${item.id}`);\r\n\r\n    const placeholder = item.images ? item.images[0] : \"https://www.unfe.org/wp-content/uploads/2019/04/SM-placeholder-1024x512.png\"\r\n\r\n    //console.log(shoppingCart);\r\n\r\n    if(shoppingCart.length > 0){\r\n \r\n        cartHasProducts = shoppingCart.some((productCart) =>{\r\n\r\n            productCart.id === item.id;\r\n\r\n        });\r\n    }\r\n\r\n    const addToCartBtnEnable = cartHasProducts ? \r\n    `<button class=\"add_cart_button\" id=\"add_cart_button\">Product added to cart</button>` :\r\n    `<button class=\"add_cart_button\" id=\"add_cart_button\">Add to cart</button>` ;\r\n\r\n    product.innerHTML = `\r\n    \r\n    \r\n    <div class=\"section__new_deals_div_product_showcase_text_itemshop\">\r\n        <img src=\"${placeholder}\" alt=\"product_pic\" class=\"product_image guitarPhoto\" id=\"product_image\">\r\n            <div class=\"product_info\">\r\n                <h2 class=\"product_price\" id=\"product_price\">${item.price}.00$</h2>\r\n                <p class=\"product_name\" id=\"product_name\">${item.nameValue}</p>\r\n                ${addToCartBtnEnable}\r\n            </div>\r\n        \r\n    </div>\r\n    \r\n\r\n    `;\r\n\r\n    itemsArea.appendChild(product);\r\n\r\n    \r\n    const btnAddToCart = product.querySelector(\".add_cart_button\");\r\n\r\n    //console.log(btnAddToCart);\r\n\r\n    btnAddToCart.addEventListener(\"click\", async (ev) =>{\r\n\r\n        ev.preventDefault();\r\n        console.log(ev);\r\n\r\n        shoppingCart.push(item);\r\n        addToCart(shoppingCart);\r\n\r\n        if(userHasLoggedIn){\r\n            await createFirebaseCart(db, userHasLoggedIn.uid, shoppingCart);\r\n        }\r\n\r\n        btnAddToCart.setAttribute(\"disabled\", true);\r\n        btnAddToCart.innerHTML = \"Product added\";\r\n\r\n        console.log(userHasLoggedIn);\r\n\r\n    });\r\n\r\n\r\n}\r\n\r\nasync function addToCart(shoppingCart){\r\n\r\n    localStorage.setItem(\"cart\", JSON.stringify(shoppingCart));\r\n\r\n\r\n}\r\n\r\nfunction getCart(){\r\n    \r\n    const localCart = localStorage.getItem(\"cart\");\r\n    return localCart ? JSON.parse(localCart) : [];\r\n}\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userHasLoggedIn = user;\r\n      cart = await getFirebaseCart(db, userHasLoggedIn.uid);\r\n      // ...\r\n    } else {\r\n        cart = getCart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    getItems();\r\n\r\n  });\r\n\r\nexport{\r\n    getItems,\r\n    displayItems,\r\n    getCart,\r\n    addToCart\r\n        \r\n}\r\n","import { getAuth, createUserWithEmailAndPassword } from \"firebase/auth\";\r\nimport {firebaseConfig, firebase} from \"../firebase_app\";\r\nimport {app} from \"../firebase_app\";\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\nimport { doc, setDoc } from \"firebase/firestore\";\r\n\r\nimport { collection, getDocs } from \"firebase/firestore\";\r\n\r\nconst db = getFirestore(app);\r\n\r\nasync function fetchItems(db){\r\n\r\n    try{\r\n        const collectionRef = collection(db, \"items\");\r\n        const { docs } = await getDocs(collectionRef);\r\n        const firebaseProducts = docs.map((doc) =>{\r\n\r\n            //console.log(doc);\r\n    \r\n            return{\r\n    \r\n                ...doc.data(),\r\n    \r\n            };\r\n    \r\n        });\r\n    \r\n        return firebaseProducts;\r\n\r\n    } catch(e){\r\n\r\n        console.log(e);\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport{\r\n\r\n    fetchItems\r\n\r\n}"],"names":["$etBjH","parcelRequire","$57226618c1b18695$var$cartHasProducts","$57226618c1b18695$var$userHasLoggedIn","$57226618c1b18695$var$db","getFirestore","$bQjlg","app","$57226618c1b18695$var$auth","$1tHc5","getAuth","$57226618c1b18695$var$cart","async","$57226618c1b18695$export$d2f92acf417bbf5d","db","$cblOc","fetchItems","e","$57226618c1b18695$export$e04ee5facf472cac","item","shoppingCart","itemsArea","product","document","createElement","className","setAttribute","id","placeholder","images","length","some","productCart","addToCartBtnEnable","innerHTML","price","nameValue","appendChild","btnAddToCart","querySelector","addEventListener","ev","preventDefault","console","log","push","$57226618c1b18695$export$576b6dd9d68b37bc","$bdlMF","createFirebaseCart","uid","localStorage","setItem","JSON","stringify","$8de76ddd0439f1ed$export$2e26f4b90cb4584f","collectionRef","collection","docs","getDocs","map","doc","data"],"version":3,"file":"shoppingCart.d043c863.js.map"}
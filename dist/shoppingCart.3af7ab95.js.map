{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,qFAQA,MAAMC,EAAUC,SAASC,eAAe,aAClCC,EAAYF,SAASC,eAAe,eAEpCE,EAAgBH,SAASC,eAAe,qBAE9C,IACIG,EADAC,EAAe,GAGnB,MAAMC,EAAKC,EAAAC,aAAaC,EAAAC,KAClBC,EAAOd,EAAAe,UAEb,SAASC,EAASC,GAEd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KA8BjB,SAAmBC,GAEf,MAAMC,EAAcnB,SAASoB,cAAc,MAC3CD,EAAYE,UAAY,UACxBF,EAAYG,UACZ,mBAOAJ,EAAAK,OAAA,4DAEYL,EAAiBM,iDAELN,EAAKO,wEAIxBC,YAAAP,KAEFQ,iBAAA,SAAAC,IAEN,WAAAA,EAAAC,OAAAC,UAEDC,QAAAC,IAAA,WA9CAC,eAAwBC,GAEpB,MAAMC,EAAU9B,EAAa+B,QAAOnB,GAAQA,EAAKiB,KAAOA,IAExD7B,EAAe8B,EAEZ/B,SAEOiC,EAAAC,mBAAmBhC,EAAIF,EAAgBmC,IAAKJ,GAItDK,EAAAC,UAAUN,GAEVpC,EAASuB,UAAY,GAErBT,EAASsB,GAgCNO,CAAAxB,EAAagB,QAxDZS,CAAU1B,GACVF,GAAS6B,SAAS3B,EAAKQ,UAI3BvB,EAAU2C,UAAY9B,EAAM+B,WAAc,SAiEhCnB,iBAAA,SAAAC,IACRvB,EAAA0C,OAAA,EAAAC,OAAAC,SAAiEC,KAAA,qBACjEC,MAAA,oEAEqBxC,GAAAsB,MAAAmB,IACtBA,GAIGhD,EAAuBgD,EACzB/C,QAAqBgC,EAAAgB,gBAAA/C,EAAAF,EAAAmC,OAEtBlC,EAAAmC,EAAAc,UAEDH,MAAA,2CAECH,OAAAC,SAAAC,KAAA","sources":["src/shoppingCart.js"],"sourcesContent":["import {getAuth, onAuthStateChanged} from \"firebase/auth\";\r\nimport {getFirebaseCart, createFirebaseCart} from \"./utils/cartFunction\";\r\nimport { addToCart, displayItems, getCart } from \"./itemShowcase\";\r\nimport { doc, onSnapshot,  getFirestore, setDoc, getDoc, collection } from \"firebase/firestore\";\r\nimport {firebaseConfig, firebase} from \"./firebase_app\";\r\nimport {app} from \"./firebase_app\";\r\nimport { initializeApp } from \"firebase/app\";\r\n\r\nconst cartArea= document.getElementById(\"item_list\");\r\nconst totalArea = document.getElementById(\"final_price\");\r\n\r\nconst proceedButton = document.getElementById(\"checkout_button_a\");\r\n\r\nlet shoppingCart = [];\r\nlet userHasLoggedIn = undefined;\r\n\r\nconst db = getFirestore(app);\r\nconst auth = getAuth();\r\n\r\nfunction loadCart(cart){\r\n\r\n    let total = 0;\r\n    cart.forEach(item =>{\r\n\r\n        displayIt(item);\r\n        total += parseInt(item.price);\r\n\r\n    });\r\n    \r\n    totalArea.innerText = total.toString()  + \".00$\";\r\n}\r\n\r\nasync function removeIt(id){\r\n\r\n    const newCart = shoppingCart.filter(item => item.id !== id);\r\n\r\n    shoppingCart = newCart;\r\n\r\n    if(userHasLoggedIn){\r\n\r\n        await createFirebaseCart(db, userHasLoggedIn.uid, newCart);\r\n\r\n    }\r\n\r\n    addToCart(newCart);\r\n\r\n    cartArea.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n\r\nfunction displayIt(product){\r\n\r\n    const productCart = document.createElement(\"li\");\r\n    productCart.className = \"product\";\r\n    productCart.innerHTML =\r\n    `\r\n    <img src=\"${product.images[0]}\" class=\"product_image\">\r\n    <h2 class=\"product_name\">${product.nameValue}</h2>\r\n    <h3 class=\"product_price\">${product.price}.00$</h3>\r\n    <button class=\"product_delete\">X</button>\r\n    `;\r\n\r\n    cartArea.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", ev =>{\r\n\r\n        if(ev.target.tagName === \"BUTTON\"){\r\n\r\n            console.log(\"removed\");\r\n            removeIt(product.id);\r\n        }\r\n\r\n    });\r\n\r\n}\r\n\r\nproceedButton.addEventListener(\"click\", ev =>{\r\n\r\n    if(shoppingCart.length > 0){\r\n\r\n        window.location.href = \"./paymentPage.html\";\r\n\r\n    }\r\n    else{\r\n        \r\n        alert(\"Could not find products in shopping cart\");\r\n\r\n    }  \r\n\r\n});\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userHasLoggedIn = user;\r\n      shoppingCart = await getFirebaseCart(db, userHasLoggedIn.uid);\r\n    } else {\r\n        shoppingCart = getCart();\r\n        alert(\"Please log in before proceeding to cart\");\r\n\r\n        window.location.href = \"./loginPage.html\";\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadCart(shoppingCart);\r\n\r\n  });\r\n\r\nexport{\r\n\r\n    shoppingCart\r\n}"],"names":["$1tHc5","parcelRequire","$3ea8329f81be6e2d$var$cartArea","document","getElementById","$3ea8329f81be6e2d$var$totalArea","$3ea8329f81be6e2d$var$proceedButton","$3ea8329f81be6e2d$var$userHasLoggedIn","$3ea8329f81be6e2d$export$6adb642bd51927fd","$3ea8329f81be6e2d$var$db","$etBjH","getFirestore","$bQjlg","app","$3ea8329f81be6e2d$var$auth","getAuth","$3ea8329f81be6e2d$var$loadCart","cart","total","forEach","item","product","productCart","createElement","className","innerHTML","images","nameValue","price","appendChild","addEventListener","ev","target","tagName","console","log","async","id","newCart","filter","$bdlMF","createFirebaseCart","uid","$7tOtO","addToCart","$3ea8329f81be6e2d$var$removeIt","$3ea8329f81be6e2d$var$displayIt","parseInt","innerText","toString","length","window","location","href","alert","user","getFirebaseCart","getCart"],"version":3,"file":"shoppingCart.3af7ab95.js.map"}